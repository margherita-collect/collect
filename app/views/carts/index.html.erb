<%= render 'layouts/header1' %>

<br>
<% @cart_items.each do |item| %>
	<div id="item_<%= item.id %>">
		<span id="image"><%= attachment_image_tag item.product, :image, :fill, 60, 60, format: 'jpeg' %></span>
		<span id="product_name"><%= item.product.product_name %>　</span>
		<% if item.product.artist.present? %>
			<span id="artist_name"><%= item.product.artist.artist_name %></span>
		<% end %>
		<span id="price">単価: <%= item.product.price %>円　</span>
		<span id="sum">小計: <%= item.product.price.to_i * item.quantity %></span>
		<br>

		<!-- 非同期個数変更 -->
		<% stock_array = [] %>
		<% item.product.stock.to_i.times do |i| (stock_array.push(i+1)) end %>
		<%= select_tag "quantity", options_for_select(stock_array,  selected: item.quantity),id: "#{item.id}", class: "select_quantity" %>


		<!-- 非同期カ商品削除 -->
		<button type="button" id="<%= item.id %>", class="delete_item">削除</button>
		<br>
		<br>
	</div>
<% end %>


<%= link_to "決済画面へ(now: 購入確定処理のリンク)", user_purchases_path, method: :post %>

<script src="/assets/cart_actions.js" type="text/javascript" charset="utf-8"></script>